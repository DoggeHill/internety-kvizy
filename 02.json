[
  {
    "question": "Which of the following statements correctly describe the main advantages of IPv6 over IPv4?",
    "options": [
      "IPv6 includes IPsec as a fundamental protocol feature.",
      "IPv6 mandates NAT for address conservation.",
      "IPv6 has a simplified header for faster processing.",
      "IPv6 natively supports multicast and anycast."
    ],
    "correct": [0, 2, 3],
    "multipleCorrect": true,
    "explanation": "IPv6 simplifies the header, integrates multicast and anycast, and mandates IPsec for security. NAT is not part of IPv6 design since address exhaustion is no longer an issue."
  },
  {
    "question": "In IPv6, what is the function of the Flow Label field?",
    "options": [
      "To provide fragmentation offset information.",
      "To identify transport layer sessions uniquely.",
      "To mark packets belonging to the same flow for special handling by routers.",
      "To indicate packet priority among flows."
    ],
    "correct": [2],
    "explanation": "The Flow Label field is used to label packets of a particular flow for routers to provide consistent QoS handling without examining transport headers."
  },
  {
    "question": "True or False: IPv6 routers can fragment packets like in IPv4.",
    "options": [
      "True",
      "False"
    ],
    "correct": [1],
    "explanation": "Routers in IPv6 do not perform fragmentation. If a packet is too large, they drop it and send an ICMPv6 'Packet Too Big' message back to the sender."
  },
  {
    "question": "Which of the following are true regarding ICMPv6?",
    "options": [
      "It is only used for Neighbor Discovery messages.",
      "It carries error messages such as Destination Unreachable and Packet Too Big.",
      "It replaces ARP, IGMP, and ICMPv4 functionality.",
      "It is mandatory in every IPv6 implementation."
    ],
    "correct": [1, 2, 3],
    "multipleCorrect": true,
    "explanation": "ICMPv6 combines several IPv4-era protocols and is essential for error reporting, diagnostics, and Neighbor Discovery. It must be implemented in all IPv6 systems."
  },
  {
    "question": "In Neighbor Discovery Protocol (NDP), which message types are used for address resolution and neighbor reachability?",
    "options": [
      "Redirect and Destination Unreachable.",
      "Router Solicitation and Router Advertisement.",
      "Neighbor Solicitation and Neighbor Advertisement.",
      "Echo Request and Echo Reply."
    ],
    "correct": [2],
    "explanation": "NDP uses Neighbor Solicitation and Advertisement messages to resolve link-layer addresses and verify neighbor reachability."
  },
  {
    "question": "What does Stateless Address Autoconfiguration (SLAAC) allow a node to do?",
    "options": [
      "Assign static addresses to routers.",
      "Manually configure subnet prefixes.",
      "Automatically generate its own IPv6 address using router advertisements.",
      "Request and assign IP addresses via DHCPv6 exclusively."
    ],
    "correct": [2],
    "explanation": "SLAAC enables a device to form its own IPv6 address using a prefix learned from router advertisements, without relying on DHCPv6."
  },
  {
    "question": "Which IPv6 routing protocols are direct successors of IPv4 protocols?",
    "options": [
      "EIGRPv6 for IGRP",
      "RIPng for RIP",
      "OSPFv3 for OSPF",
      "BGP-4+ for BGP"
    ],
    "correct": [0, 1, 2, 3],
    "multipleCorrect": true,
    "explanation": "IPv6 versions of IPv4 routing protocols exist—RIPng, OSPFv3, and BGP-4+—all adapted to operate with 128-bit IPv6 addresses."
  },
  {
    "question": "True or False: OSPFv3 exchanges IPv6 routing information using IPv4 transport.",
    "options": [
      "True",
      "False"
    ],
    "correct": [1],
    "explanation": "OSPFv3 runs directly over IPv6 using protocol number 89, not over IPv4 transport."
  },
  {
    "question": "Which mechanisms support the coexistence of IPv4 and IPv6?",
    "options": [
      "Header translation (NAT64).",
      "Dual stack operation.",
      "Tunneling IPv6 packets through IPv4 networks.",
      "Exclusive IPv6-only deployment."
    ],
    "correct": [0, 1, 2],
    "multipleCorrect": true,
    "explanation": "Transition mechanisms include dual stack for interoperability, tunneling to traverse IPv4 networks, and translation between address families like NAT64."
  },
  {
    "question": "True or False: Mobile IPv6 allows devices to maintain existing connections while moving between networks.",
    "options": [
      "True",
      "False"
    ],
    "correct": [0],
    "explanation": "Mobile IPv6 introduces home and care-of addresses allowing seamless handovers without breaking ongoing connections."
  },
  {
    "question": "What is the size of an IPv6 address?",
    "options": [
      "32 bits",
      "64 bits",
      "128 bits",
      "256 bits"
    ],
    "correct": [2],
    "explanation": "IPv6 addresses are 128 bits long, compared to IPv4's 32 bits, providing approximately 3.4×10^38 unique addresses."
  },
  {
    "question": "Which IPv6 address type is used for one-to-nearest communication?",
    "options": [
      "Anycast",
      "Broadcast",
      "Unicast",
      "Multicast"
    ],
    "correct": [0],
    "explanation": "Anycast addresses allow packets to be routed to the nearest node in a group. IPv6 does not support broadcast; it uses multicast instead."
  },
  {
    "question": "What is the IPv6 loopback address?",
    "options": [
      "Both ::1 and 0:0:0:0:0:0:0:1",
      "0:0:0:0:0:0:0:1",
      "::1",
      "127.0.0.1"
    ],
    "correct": [0],
    "explanation": "The IPv6 loopback address is ::1 (compressed form) or 0:0:0:0:0:0:0:1 (full form), equivalent to 127.0.0.1 in IPv4."
  },
  {
    "question": "Which ICMPv6 message type is used when a router cannot forward a packet?",
    "options": [
      "Destination Unreachable",
      "Time Exceeded",
      "Parameter Problem",
      "Packet Too Big"
    ],
    "correct": [0],
    "explanation": "Destination Unreachable is sent when a router cannot forward a packet to its destination for various reasons (no route, prohibited, etc.)."
  },
  {
    "question": "What is the minimum MTU size required for IPv6 links?",
    "options": [
      "576 bytes",
      "1500 bytes",
      "9000 bytes",
      "1280 bytes"
    ],
    "correct": [3],
    "explanation": "IPv6 requires a minimum MTU of 1280 bytes on all links. If a physical link cannot support this, link-specific fragmentation and reassembly must be provided."
  },
  {
    "question": "Which field in the IPv6 header indicates the upper-layer protocol?",
    "options": [
      "Protocol",
      "Next Header",
      "Type of Service",
      "Traffic Class"
    ],
    "correct": [1],
    "explanation": "The Next Header field in IPv6 serves the same purpose as the Protocol field in IPv4, identifying the type of header following the IPv6 header."
  },
  {
    "question": "What does the prefix fe80::/10 indicate?",
    "options": [
      "Link-local address",
      "Global unicast address",
      "Unique local address",
      "Multicast address"
    ],
    "correct": [0],
    "explanation": "fe80::/10 is reserved for link-local addresses, which are used for communication on a single link and are not routable."
  },
  {
    "question": "Which NDP message does a host send to find its default gateway?",
    "options": [
      "Neighbor Solicitation",
      "Neighbor Advertisement",
      "Router Solicitation",
      "Router Advertisement"
    ],
    "correct": [2],
    "explanation": "Hosts send Router Solicitation messages to discover routers on the link. Routers respond with Router Advertisements."
  },
  {
    "question": "What is the purpose of Duplicate Address Detection (DAD)?",
    "options": [
      "To detect router failures",
      "To compress IPv6 addresses",
      "To find the MAC address of a neighbor",
      "To prevent IP address conflicts on a network"
    ],
    "correct": [3],
    "explanation": "DAD is used by a node to determine if an address is already in use on the link before assigning it to an interface."
  },
  {
    "question": "Which IPv6 extension header is used for fragmentation?",
    "options": [
      "Destination Options",
      "Hop-by-Hop Options",
      "Fragment Header",
      "Routing Header"
    ],
    "correct": [2],
    "explanation": "The Fragment Header is used when a source node must fragment a packet because it exceeds the path MTU. Only the source performs fragmentation in IPv6."
  },
  {
    "question": "What does the IPv6 address :: represent?",
    "options": [
      "A multicast address",
      "The default route",
      "All zeros (unspecified address)",
      "The loopback address"
    ],
    "correct": [2],
    "explanation": ":: represents all zeros and is called the unspecified address. It's used by hosts that don't yet have an address assigned."
  },
  {
    "question": "Which DHCPv6 mode provides only configuration information, not addresses?",
    "options": [
      "Stateful DHCPv6",
      "Stateless DHCPv6",
      "DHCPv6-PD",
      "Rapid DHCPv6"
    ],
    "correct": [1],
    "explanation": "Stateless DHCPv6 provides configuration information (like DNS servers) while hosts use SLAAC for address assignment."
  },
  {
    "question": "What is the IPv6 multicast address for all routers on a link?",
    "options": [
      "ff02::1",
      "ff02::2",
      "ff05::2",
      "ff0e::1"
    ],
    "correct": [1],
    "explanation": "ff02::2 is the link-local multicast address for all routers. ff02::1 is for all nodes, ff05::2 is site-local all routers."
  },
  {
    "question": "Which transition mechanism encapsulates IPv6 packets in IPv4 for transport?",
    "options": [
      "Dual stack",
      "DNS64",
      "NAT64",
      "6to4 tunneling"
    ],
    "correct": [3],
    "explanation": "6to4 is a tunneling mechanism that encapsulates IPv6 packets within IPv4 packets to traverse IPv4 networks. Dual stack runs both protocols natively."
  },
  {
    "question": "What does the 'M' flag in a Router Advertisement indicate?",
    "options": [
      "Multicast is supported",
      "Use DHCPv6 for address configuration (Managed)",
      "Mobile IPv6 is enabled",
      "MTU information is included"
    ],
    "correct": [1],
    "explanation": "The Managed address configuration (M) flag tells hosts to use DHCPv6 for address assignment rather than SLAAC."
  },
  {
    "question": "Which IPv6 address scope is indicated by ff05::/16?",
    "options": [
      "Global",
      "Interface-local",
      "Site-local",
      "Link-local"
    ],
    "correct": [2],
    "explanation": "The fourth hexadecimal digit (5) in multicast addresses indicates site-local scope. ff02 is link-local, ff0e is global."
  },
  {
    "question": "What is the purpose of the Hop Limit field in IPv6?",
    "options": [
      "To limit the number of hops a packet can take",
      "To specify the number of extension headers",
      "To indicate packet priority",
      "To set the maximum packet size"
    ],
    "correct": [0],
    "explanation": "Hop Limit functions like TTL in IPv4, decremented by each router. When it reaches 0, the packet is discarded to prevent routing loops."
  },
  {
    "question": "Which address block is reserved for unique local addresses (ULA)?",
    "options": [
      "fe80::/10",
      "ff00::/8",
      "fc00::/7",
      "2001::/16"
    ],
    "correct": [2],
    "explanation": "fc00::/7 (fc00::/8 and fd00::/8) is reserved for unique local addresses, similar to RFC 1918 private addresses in IPv4."
  },
  {
    "question": "What does Path MTU Discovery (PMTUD) determine?",
    "options": [
      "The optimal QoS settings for a path",
      "The number of routers between source and destination",
      "The maximum packet size that can be sent without fragmentation",
      "The fastest route to a destination"
    ],
    "correct": [2],
    "explanation": "PMTUD discovers the smallest MTU along the path to avoid fragmentation. It's more important in IPv6 since routers don't fragment."
  },
  {
    "question": "Which ICMPv6 type is used for Neighbor Solicitation?",
    "options": [
      "Type 133",
      "Type 134",
      "Type 135",
      "Type 136"
    ],
    "correct": [2],
    "explanation": "Type 135 is Neighbor Solicitation, Type 136 is Neighbor Advertisement, Type 133 is Router Solicitation, Type 134 is Router Advertisement."
  },
  {
    "question": "Which NDP message is sent by routers to proactively advertise their presence?",
    "options": [
      "Redirect",
      "Neighbor Solicitation",
      "Router Advertisement",
      "Router Solicitation"
    ],
    "correct": [2],
    "explanation": "Router Advertisement messages are sent periodically by routers or in response to Router Solicitation messages to advertise their presence and configuration parameters."
  },
  {
    "question": "What information can be included in NDP Router Advertisements?",
    "options": [
      "Flags indicating address configuration method",
      "MTU size for the link",
      "MAC addresses of all hosts",
      "Prefix information for SLAAC"
    ],
    "correct": [0, 1, 3],
    "multipleCorrect": true,
    "explanation": "Router Advertisements can include prefixes for autoconfiguration, link MTU, hop limit values, and flags (M and O) for address and other configuration."
  },
  {
    "question": "In Mobile IPv6, what is the purpose of a Home Agent?",
    "options": [
      "To intercept packets destined for the mobile node's home address",
      "To assign temporary IP addresses",
      "To compress IPv6 headers for mobile devices",
      "To tunnel packets to the mobile node's current location"
    ],
    "correct": [0, 3],
    "multipleCorrect": true,
    "explanation": "The Home Agent intercepts packets sent to the mobile node's home address and tunnels them to the mobile node's care-of address at its current location."
  },
  {
    "question": "What is a Care-of Address in Mobile IPv6?",
    "options": [
      "The address used for return routability testing",
      "The address of the home agent",
      "A temporary address indicating the mobile node's current location",
      "The permanent address assigned to a mobile node"
    ],
    "correct": [2],
    "explanation": "A care-of address is a temporary IPv6 address that reflects the mobile node's current point of attachment to the Internet."
  },
  {
    "question": "Which IPv6 security feature was mandatory in the original specification?",
    "options": [
      "TLS",
      "IPsec",
      "SSH",
      "DNSSEC"
    ],
    "correct": [1],
    "explanation": "IPsec was originally mandatory in IPv6 (though this requirement was later relaxed). It provides authentication, integrity, and confidentiality at the network layer."
  },
  {
    "question": "What are the two main IPsec protocols used in IPv6?",
    "options": [
      "AH (Authentication Header)",
      "SSL (Secure Sockets Layer)",
      "ESP (Encapsulating Security Payload)",
      "TLS (Transport Layer Security)"
    ],
    "correct": [0, 2],
    "multipleCorrect": true,
    "explanation": "AH provides authentication and integrity, while ESP provides confidentiality (encryption) in addition to authentication and integrity."
  },
  {
    "question": "How does IPv6 use the Traffic Class field for QoS?",
    "options": [
      "To determine routing paths",
      "To compress multimedia packets",
      "To encrypt quality-sensitive traffic",
      "To mark packets with priority or DSCP values"
    ],
    "correct": [3],
    "explanation": "The Traffic Class field (8 bits) is used similarly to ToS in IPv4, allowing packets to be marked with DiffServ Code Points (DSCP) for QoS treatment."
  },
  {
    "question": "What security risk is associated with NDP in IPv6?",
    "options": [
      "NDP prevents all man-in-the-middle attacks",
      "NDP messages can be spoofed without protection",
      "NDP automatically encrypts all traffic",
      "NDP requires certificate authentication by default"
    ],
    "correct": [1],
    "explanation": "Without SEND (Secure Neighbor Discovery), NDP messages are vulnerable to spoofing attacks, allowing attackers to redirect traffic or perform DoS attacks."
  },
  {
    "question": "What is SEND (Secure Neighbor Discovery)?",
    "options": [
      "A routing protocol for IPv6 networks",
      "A method for address allocation",
      "A protocol that uses cryptographic signatures to secure NDP messages",
      "A compression algorithm for IPv6 packets"
    ],
    "correct": [2],
    "explanation": "SEND uses Cryptographically Generated Addresses (CGA) and RSA signatures to authenticate NDP messages and prevent spoofing attacks."
  },
  {
    "question": "Which type of attack can be performed by spoofing Router Advertisement messages?",
    "options": [
      "Man-in-the-middle attack by advertising a rogue router",
      "Denial of service by advertising invalid prefixes",
      "SQL injection",
      "Redirect legitimate traffic to attacker"
    ],
    "correct": [0, 1, 3],
    "multipleCorrect": true,
    "explanation": "Rogue RA attacks can redirect traffic, cause DoS by invalidating legitimate prefixes, or position the attacker as a man-in-the-middle."
  },
  {
    "question": "What is the purpose of the Redirect message in NDP?",
    "options": [
      "To inform a host of a better first-hop router for a specific destination",
      "To redirect DNS queries to a different server",
      "To change a host's IPv6 address",
      "To block malicious traffic"
    ],
    "correct": [0],
    "explanation": "Routers send Redirect messages to inform hosts about better routes to specific destinations, optimizing path selection."
  },
  {
    "question": "In Mobile IPv6, what is Route Optimization?",
    "options": [
      "A mechanism allowing direct communication between correspondent nodes and mobile nodes",
      "Compressing routing tables",
      "Reducing the number of hops in a network",
      "Automatically selecting the fastest ISP"
    ],
    "correct": [0],
    "explanation": "Route Optimization allows correspondent nodes to send packets directly to a mobile node's care-of address, bypassing the home agent for efficiency."
  },
  {
    "question": "What is Binding Update in Mobile IPv6?",
    "options": [
      "A message sent by the mobile node to register its care-of address",
      "An update to the routing table",
      "A security certificate renewal",
      "A DNS record update"
    ],
    "correct": [0],
    "explanation": "Binding Update messages inform the home agent (and optionally correspondent nodes) about the mobile node's current care-of address."
  },
  {
    "question": "Which IPv6 extension header is used by IPsec for authentication?",
    "options": [
      "Routing Header",
      "Authentication Header (AH)",
      "Hop-by-Hop Options",
      "Fragment Header"
    ],
    "correct": [1],
    "explanation": "The Authentication Header provides connectionless integrity, data origin authentication, and optional anti-replay protection for IPv6 packets."
  },
  {
    "question": "What is the main difference between AH and ESP in IPsec?",
    "options": [
      "AH provides authentication only, ESP provides encryption and authentication",
      "AH is for IPv4, ESP is for IPv6",
      "AH is faster than ESP",
      "ESP cannot work with NAT"
    ],
    "correct": [0],
    "explanation": "AH provides authentication and integrity but not encryption. ESP can provide confidentiality (encryption), authentication, and integrity."
  },
  {
    "question": "How does IPv6 Privacy Extensions enhance security?",
    "options": [
      "By generating temporary random interface identifiers",
      "By encrypting all IPv6 headers",
      "By hiding the MAC address in Router Advertisements",
      "By using shorter addresses"
    ],
    "correct": [0],
    "explanation": "Privacy Extensions (RFC 4941) generate temporary, changing interface IDs instead of using MAC-based identifiers, preventing tracking across networks."
  },
  {
    "question": "What is a Cryptographically Generated Address (CGA)?",
    "options": [
      "An encrypted IPv6 address",
      "An address assigned by DHCP with encryption",
      "A randomly generated temporary address",
      "An IPv6 address generated from a public key hash"
    ],
    "correct": [3],
    "explanation": "CGAs use a hash of a public key to generate the interface identifier, allowing proof of address ownership through digital signatures."
  },
  {
    "question": "Which NDP option is used to advertise the link-layer address?",
    "options": [
      "Source Link-Layer Address option",
      "Target Link-Layer Address option",
      "MTU option",
      "Prefix Information option"
    ],
    "correct": [0, 1],
    "multipleCorrect": true,
    "explanation": "Source Link-Layer Address is used in Router/Neighbor Solicitation and Router/Neighbor Advertisement. Target Link-Layer Address is used in Neighbor Advertisement and Redirect."
  },
  {
    "question": "What happens during the Neighbor Unreachability Detection (NUD) process?",
    "options": [
      "Hosts discover available bandwidth",
      "The network assigns new addresses",
      "Routers detect link failures",
      "Hosts verify that neighbors are still reachable"
    ],
    "correct": [3],
    "explanation": "NUD allows hosts to track the reachability status of neighbors and detect when a neighbor is no longer reachable, updating the neighbor cache accordingly."
  },
  {
    "question": "What are the possible states in the NDP neighbor cache?",
    "options": [
      "INCOMPLETE - waiting for address resolution",
      "REACHABLE - known to be reachable",
      "STALE - no recent reachability confirmation",
      "ENCRYPTED - secure connection established"
    ],
    "correct": [0, 1, 2],
    "multipleCorrect": true,
    "explanation": "NDP defines states including INCOMPLETE, REACHABLE, STALE, DELAY, and PROBE to track neighbor reachability. There is no ENCRYPTED state."
  },
  {
    "question": "In Mobile IPv6, what is Return Routability Test (RRT)?",
    "options": [
      "A method to find the shortest path",
      "A security mechanism to verify the mobile node owns both home and care-of addresses",
      "A speed test for mobile connections",
      "A QoS measurement tool"
    ],
    "correct": [1],
    "explanation": "RRT is a security procedure where correspondent nodes verify that the mobile node is reachable at both its home address and care-of address before enabling route optimization."
  },
  {
    "question": "What is the purpose of the 'O' flag in Router Advertisements?",
    "options": [
      "Optimizes routing tables",
      "Opens firewall ports",
      "Indicates hosts should use DHCPv6 for other configuration (not addresses)",
      "Enables IPv6 over IPv4 tunneling"
    ],
    "correct": [2],
    "explanation": "The Other configuration (O) flag tells hosts to use DHCPv6 to obtain additional configuration information like DNS servers, while still using SLAAC for addresses."
  },
  {
    "question": "How does IPsec transport mode differ from tunnel mode?",
    "options": [
      "Tunnel mode creates a new IP header, transport mode doesn't",
      "Transport mode works only with TCP",
      "Transport mode encrypts only the payload, tunnel mode encrypts the entire packet",
      "Transport mode is faster than tunnel mode"
    ],
    "correct": [0, 2],
    "multipleCorrect": true,
    "explanation": "In transport mode, only the payload is protected. In tunnel mode, the entire original packet is encapsulated in a new IPv6 packet, often used for VPNs."
  },
  {
    "question": "What is the Flow Label field used for in IPv6 QoS?",
    "options": [
      "To identify packets belonging to the same flow for consistent QoS treatment",
      "To encrypt flows",
      "To count the number of flows",
      "To compress packet headers"
    ],
    "correct": [0],
    "explanation": "The 20-bit Flow Label allows routers to identify packets belonging to the same flow and handle them consistently without examining upper-layer headers."
  },
  {
    "question": "Which security feature helps prevent IPv6 address scanning attacks?",
    "options": [
      "All subnet addresses are always allocated",
      "The large address space makes brute-force scanning impractical",
      "SEND protocol",
      "Randomized interface identifiers"
    ],
    "correct": [1, 3],
    "multipleCorrect": true,
    "explanation": "The huge IPv6 address space (2^64 addresses per subnet) makes scanning impractical, and randomized IDs prevent predictable addressing patterns."
  },
  {
    "question": "What is a Mobile IPv6 Correspondent Node?",
    "options": [
      "A node communicating with a mobile node",
      "A router managing mobile connections",
      "A DNS server for mobile devices",
      "A backup home agent"
    ],
    "correct": [0],
    "explanation": "A correspondent node is any IPv6 node that is communicating with a mobile node, which may be mobile or stationary."
  },
  {
    "question": "How does NDP prevent address conflicts?",
    "options": [
      "Through Duplicate Address Detection (DAD)",
      "By limiting the number of hosts",
      "By using DHCP exclusively",
      "Through encryption"
    ],
    "correct": [0],
    "explanation": "DAD uses Neighbor Solicitation messages to check if an address is already in use before a node configures it on its interface."
  },
  {
    "question": "What is the Router Preference option in NDP?",
    "options": [
      "Sets bandwidth limits for routers",
      "Determines router uptime",
      "Configures router encryption strength",
      "Allows routers to advertise their preference level (high, medium, low)"
    ],
    "correct": [3],
    "explanation": "The Router Preference option allows routers to indicate their relative preference for use as a default router, helping hosts choose the best default gateway."
  },
  {
    "question": "Which extension header would be used for end-to-end encryption in IPv6?",
    "options": [
      "Hop-by-Hop Options",
      "Fragment Header",
      "Routing Header",
      "ESP (Encapsulating Security Payload)"
    ],
    "correct": [3],
    "explanation": "ESP provides encryption and can be used in transport mode for end-to-end encryption between source and destination."
  },
  {
    "question": "What is RA Guard?",
    "options": [
      "A security feature that filters Router Advertisement messages",
      "A QoS mechanism",
      "A routing protocol",
      "A compression algorithm"
    ],
    "correct": [0],
    "explanation": "RA Guard is a switch security feature that blocks rogue Router Advertisement messages from unauthorized devices, preventing attacks."
  },
  {
    "question": "During Duplicate Address Detection (DAD), what does a node do before assigning an address?",
    "options": [
      "Sends a Router Advertisement to all nodes",
      "Broadcasts an ARP request",
      "Queries the DHCP server",
      "Sends a Neighbor Solicitation with the tentative address as the target"
    ],
    "correct": [3],
    "explanation": "The node sends a Neighbor Solicitation message with the unspecified address (::) as source and the tentative address as the target to check if anyone else is using it."
  },
  {
    "question": "What is the source address used in DAD Neighbor Solicitation messages?",
    "options": [
      "The link-local address",
      "The global unicast address",
      "The unspecified address (::)",
      "The tentative address being tested"
    ],
    "correct": [2],
    "explanation": "During DAD, the source address is the unspecified address (::) because the node hasn't confirmed ownership of any address yet."
  },
  {
    "question": "If a node receives a Neighbor Advertisement in response to its DAD message, what should it do?",
    "options": [
      "Request a new address from DHCPv6",
      "Ignore the message and use the address anyway",
      "Send another DAD message",
      "Not use the tentative address as it's a duplicate"
    ],
    "correct": [3],
    "explanation": "If a node receives a response during DAD, it means another node is already using that address. The node must not use the duplicate address."
  },
  {
    "question": "How many DAD messages must a node send before considering an address safe to use?",
    "options": [
      "Exactly 3",
      "At least 5",
      "Continuously until stopped",
      "At least 1 (DupAddrDetectTransmits default)"
    ],
    "correct": [3],
    "explanation": "The number is configurable via DupAddrDetectTransmits, with a default of 1. The node must wait RetransTimer milliseconds for responses."
  },
  {
    "question": "What is the purpose of the tentative address state in DAD?",
    "options": [
      "To flag addresses assigned by DHCPv6",
      "To identify temporary privacy addresses",
      "To indicate an address is being tested and cannot yet be used for communication",
      "To mark addresses that will expire soon"
    ],
    "correct": [2],
    "explanation": "During the tentative state, the address cannot be used for regular communication except for DAD, NUD, and Router Solicitation messages."
  },
  {
    "question": "In Neighbor Unreachability Detection, what triggers the transition from REACHABLE to STALE?",
    "options": [
      "A packet is sent to the neighbor",
      "The router restarts",
      "The ReachableTime timer expires",
      "The neighbor sends an error message"
    ],
    "correct": [2],
    "explanation": "When ReachableTime expires without any reachability confirmation, the neighbor entry transitions from REACHABLE to STALE state."
  },
  {
    "question": "What are the five states in the NUD state machine?",
    "options": [
      "INCOMPLETE, REACHABLE, STALE, DELAY, PROBE",
      "INIT, READY, ACTIVE, SUSPEND, TERMINATE",
      "DISCOVER, OFFER, REQUEST, ACKNOWLEDGE, BOUND",
      "NEW, VERIFIED, EXPIRED, INVALID, DELETED"
    ],
    "correct": [0],
    "explanation": "NUD uses five states to track neighbor reachability: INCOMPLETE (resolving), REACHABLE (confirmed reachable), STALE (unknown), DELAY (waiting), and PROBE (actively probing)."
  },
  {
    "question": "How does a node confirm forward reachability in NUD?",
    "options": [
      "By checking DNS records",
      "By receiving upper-layer protocol confirmation (e.g., TCP ACK)",
      "By monitoring ARP tables",
      "By sending ICMP Echo Requests"
    ],
    "correct": [1],
    "explanation": "Forward reachability is confirmed through upper-layer protocols (like TCP acknowledgments) indicating successful two-way communication."
  },
  {
    "question": "What happens when a node in STALE state needs to send packets to a neighbor?",
    "options": [
      "It stays in STALE state indefinitely",
      "It immediately transitions to PROBE state",
      "It transitions to DELAY state and sets a timer",
      "It deletes the neighbor cache entry"
    ],
    "correct": [2],
    "explanation": "When sending to a STALE neighbor, the entry moves to DELAY. If no reachability confirmation arrives within DELAY_FIRST_PROBE_TIME, it transitions to PROBE."
  },
  {
    "question": "In the PROBE state, what does a node do to verify neighbor reachability?",
    "options": [
      "Sends multicast Router Solicitation messages",
      "Broadcasts ARP requests",
      "Sends unicast Neighbor Solicitation messages",
      "Sends ICMP Echo Requests"
    ],
    "correct": [2],
    "explanation": "In PROBE state, the node sends unicast Neighbor Solicitation messages directly to the cached link-layer address to verify reachability."
  },
  {
    "question": "What information does a Router Advertisement provide for SLAAC?",
    "options": [
      "Complete IPv6 addresses",
      "Prefix lifetime (valid and preferred)",
      "On-link and autonomous flags",
      "Network prefix and prefix length"
    ],
    "correct": [1, 2, 3],
    "multipleCorrect": true,
    "explanation": "Router Advertisements include prefix information with length, lifetimes, and flags. Nodes use this to generate their own complete addresses via SLAAC."
  },
  {
    "question": "What is the difference between valid lifetime and preferred lifetime in SLAAC?",
    "options": [
      "Valid lifetime is how long an address can be used; preferred lifetime is how long it should be used for new connections",
      "They are the same value",
      "Valid is for unicast, preferred is for multicast",
      "Valid is assigned by routers, preferred by hosts"
    ],
    "correct": [0],
    "explanation": "Addresses remain valid for the valid lifetime but should only be used for new connections during the preferred lifetime. Deprecated addresses (preferred lifetime expired) can still receive traffic."
  },
  {
    "question": "How does a host generate its interface identifier using EUI-64 format?",
    "options": [
      "Uses the MAC address directly without modification",
      "Inserts FF:FE in the middle of the MAC address and flips the universal/local bit",
      "Generates a random 64-bit number",
      "Hashes the MAC address with SHA-256"
    ],
    "correct": [1],
    "explanation": "EUI-64 takes a 48-bit MAC address, inserts FF:FE in the middle to create 64 bits, and inverts the 7th bit (universal/local bit) to create the interface ID."
  },
  {
    "question": "What is the A flag in the Prefix Information option of Router Advertisements?",
    "options": [
      "Anycast address flag",
      "Authentication required flag",
      "Administrative preference flag",
      "Autonomous address-configuration flag indicating SLAAC is allowed"
    ],
    "correct": [3],
    "explanation": "The A (autonomous) flag indicates whether the prefix can be used for stateless address autoconfiguration (SLAAC)."
  },
  {
    "question": "What is the L flag in the Prefix Information option?",
    "options": [
      "Link-local flag",
      "Lifetime extension flag",
      "On-link flag indicating addresses with this prefix are on the same link",
      "Loopback flag"
    ],
    "correct": [2],
    "explanation": "The L (on-link) flag indicates that addresses with this prefix are assigned to the link and can be reached directly without routing."
  },
  {
    "question": "What security vulnerability exists with standard SLAAC?",
    "options": [
      "No authentication of Router Advertisements",
      "Addresses are transmitted in cleartext",
      "Rogue routers can advertise malicious prefixes",
      "Interface identifiers based on MAC addresses enable tracking"
    ],
    "correct": [0, 2, 3],
    "multipleCorrect": true,
    "explanation": "SLAAC vulnerabilities include rogue RA attacks, privacy issues with MAC-based addresses, and lack of RA authentication without SEND."
  },
  {
    "question": "How do Privacy Extensions (RFC 4941) improve SLAAC security?",
    "options": [
      "Use shorter addresses",
      "Generate random, temporary interface identifiers instead of MAC-based ones",
      "Require password authentication",
      "Encrypt the IPv6 address"
    ],
    "correct": [1],
    "explanation": "Privacy Extensions generate cryptographically random interface IDs that change periodically, preventing tracking based on stable MAC-derived identifiers."
  },
  {
    "question": "What is the difference between temporary and stable addresses in Privacy Extensions?",
    "options": [
      "Stable addresses cannot send traffic",
      "Temporary addresses change periodically for privacy; stable addresses remain constant",
      "Temporary addresses are for IPv4, stable for IPv6",
      "Temporary addresses are shorter"
    ],
    "correct": [1],
    "explanation": "Privacy Extensions create both stable addresses (for servers/incoming connections) and temporary addresses (for outgoing connections that change regularly)."
  },
  {
    "question": "How does SEND (Secure Neighbor Discovery) protect against NDP attacks?",
    "options": [
      "Encrypts all NDP traffic",
      "Requires DHCP authentication",
      "Validates NDP messages with digital certificates",
      "Uses cryptographic signatures based on CGA"
    ],
    "correct": [2, 3],
    "multipleCorrect": true,
    "explanation": "SEND uses Cryptographically Generated Addresses (CGA) and RSA signatures to authenticate NDP messages, preventing spoofing and man-in-the-middle attacks."
  },
  {
    "question": "What is the CGA modifier in Cryptographically Generated Addresses?",
    "options": [
      "A random encryption key",
      "A timestamp for address expiration",
      "The router's MAC address",
      "A value used to make the first 16 bits of the hash match a security parameter"
    ],
    "correct": [3],
    "explanation": "The CGA modifier is brute-forced to produce a hash where the leftmost Sec*16 bits are zero, making address forgery computationally expensive."
  },
  {
    "question": "What are the components used to generate a CGA?",
    "options": [
      "IPv6 subnet prefix",
      "CGA modifier",
      "MAC address",
      "Public key"
    ],
    "correct": [0, 1, 3],
    "multipleCorrect": true,
    "explanation": "CGAs are generated using the subnet prefix, modifier value, and the hash of the public key and other parameters, binding the address to the public key."
  },
  {
    "question": "What attack does SEND's timestamp option help prevent?",
    "options": [
      "Replay attacks",
      "Buffer overflow",
      "SQL injection",
      "Cross-site scripting"
    ],
    "correct": [0],
    "explanation": "SEND includes timestamp options to detect and reject replayed NDP messages, ensuring freshness and preventing replay attacks."
  },
  {
    "question": "What is the purpose of the Nonce option in SEND?",
    "options": [
      "To compress packet headers",
      "To match solicitation messages with their responses",
      "To calculate checksums",
      "To encrypt NDP messages"
    ],
    "correct": [1],
    "explanation": "The Nonce option ensures that advertisement messages correspond to specific solicitation messages, preventing off-path attacks."
  },
  {
    "question": "How does SeND prevent address resolution attacks?",
    "options": [
      "By using only DHCPv6",
      "By requiring proof of address ownership through CGA verification",
      "By disabling autoconfiguration",
      "By encrypting all traffic"
    ],
    "correct": [1],
    "explanation": "With SEND, a node must prove ownership of an address by providing the CGA parameters and signing messages with the corresponding private key."
  },
  {
    "question": "What is the RSA Signature option used for in SEND?",
    "options": [
      "To provide digital signature for NDP message authentication",
      "To compress the packet",
      "To encrypt the payload",
      "To indicate routing preferences"
    ],
    "correct": [0],
    "explanation": "The RSA Signature option contains a digital signature covering the NDP message, allowing recipients to verify the sender's identity and message integrity."
  },
  {
    "question": "What happens if a node performing DAD receives a Neighbor Solicitation for the same tentative address?",
    "options": [
      "Both nodes have detected a duplicate and must not use the address",
      "The router assigns a new address to both",
      "The first node wins and keeps the address",
      "Both nodes can use the address simultaneously"
    ],
    "correct": [0],
    "explanation": "If both nodes are performing DAD for the same address simultaneously, both detect the conflict and neither should use the address."
  },
  {
    "question": "What is Optimistic DAD (RFC 4429)?",
    "options": [
      "Performs DAD only for global addresses",
      "Uses hardware-based duplicate detection",
      "Allows using an address before DAD completes, with restrictions",
      "Skips DAD entirely for faster configuration"
    ],
    "correct": [2],
    "explanation": "Optimistic DAD allows limited use of an address (sending but not receiving) before DAD completes, reducing configuration delays while maintaining safety."
  },
  {
    "question": "Which types of addresses require DAD to be performed?",
    "options": [
      "The unspecified address (::)",
      "Anycast addresses",
      "Unicast addresses",
      "Multicast addresses"
    ],
    "correct": [1, 2],
    "multipleCorrect": true,
    "explanation": "DAD must be performed on all unicast and anycast addresses before use. Multicast addresses don't need DAD, and the unspecified address is never assigned."
  },
  {
    "question": "What is the purpose of the Router Lifetime field in Router Advertisements?",
    "options": [
      "Specifies how long the router has been running",
      "Determines prefix validity",
      "Indicates how long the router should be used as a default router",
      "Sets the TTL for packets"
    ],
    "correct": [2],
    "explanation": "Router Lifetime tells hosts how long (in seconds) they should consider this router as a valid default router. A value of 0 means it should not be used as default."
  },
  {
    "question": "What security risk does IPv6 address scanning face compared to IPv4?",
    "options": [
      "IPv6 addresses are encrypted by default",
      "The huge address space makes brute-force scanning impractical",
      "IPv6 doesn't allow port scanning",
      "All IPv6 addresses are hidden from scanners"
    ],
    "correct": [1],
    "explanation": "With 2^64 possible addresses per subnet, random scanning is computationally infeasible in IPv6, unlike IPv4's smaller address spaces."
  }
]